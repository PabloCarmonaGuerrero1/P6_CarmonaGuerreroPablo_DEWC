import{a as m}from"./axios-Bo0ATomq.js";import{_ as f,c as l,a as t,t as d,b as P,n as g,F as u,f as h,d as v,T as I,o as c,e as C,w as k,i as M,r as y}from"./index-Co1rkqzz.js";const b={data(){return{userInfo:{},userFriends:[],commentInfo:[],currentPage:1,commentsPerPage:3,num_comments:0,isModalOpen:!1,rickAndMortyCharacters:[],page:1,totalPagesImage:0,isLightMode:localStorage.getItem("light-mode")==="true"}},mounted(){this.getUserInfo(),this.getUserFriends(),this.getComments(),this.getRickAndMortyCharacters()},computed:{totalPages(){return Math.ceil(this.commentInfo.length/this.commentsPerPage)},paginatedComments(){const r=(this.currentPage-1)*this.commentsPerPage,e=r+this.commentsPerPage;return this.commentInfo.slice(r,e)}},methods:{async getUserInfo(){try{const e=`http://localhost/api/v1/users/${localStorage.getItem("username")}`,i=await m.get(e);this.userInfo=i.data}catch(r){console.error("Error fetching user information:",r)}},async getUserFriends(){try{const e=`http://localhost/api/v1/friendships/${localStorage.getItem("username")}`,i=await m.get(e);this.userFriends=i.data.map(n=>n.username_friend)}catch(r){console.error("Error fetching user friends:",r)}},logout(){localStorage.removeItem("username"),this.$router.push("/login")},saveFriendAndNavigate(r){localStorage.setItem("selectedFriend",r),this.$router.push("/other-user")},async getComments(){try{const e=`http://localhost/api/v1/comments/${localStorage.getItem("username")}`,i=await m.get(e);this.commentInfo=i.data,this.num_comments=this.commentInfo.length,this.commentInfo.sort((n,o)=>n.created_at>o.created_at?-1:n.created_at<o.created_at?1:n.id-o.id)}catch(r){console.error("Error fetching comments:",r)}},formatDate(r){const e=new Date(r);return`${e.getDate()}/${e.getMonth()+1}/${e.getFullYear()}`},toggleModal(){this.isModalOpen=!this.isModalOpen},async getRickAndMortyCharacters(){try{const r=`https://rickandmortyapi.com/api/character?page=${this.page}`,e=await m.get(r);this.rickAndMortyCharacters=e.data.results,this.totalPagesImage=e.data.info.pages}catch(r){console.error("Error fetching Rick and Morty characters:",r)}},selectCharacter(r){this.submit(r.image)},async submit(r){try{const i=`http://localhost/api/v1/users/${localStorage.getItem("username")}`,n=await m.put(i,{idicon:r});this.getUserInfo()}catch(e){console.error("Error submitting selected character:",e)}},nextPageImage(){this.page<this.totalPagesImage&&(this.page++,this.getRickAndMortyCharacters())},previousPageImage(){this.page>1&&(this.page--,this.getRickAndMortyCharacters())},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},previousPage(){this.currentPage>1&&this.currentPage--},formatComment(r){return r.split(" ").map(n=>n.startsWith("#")?`<span class="hashtag">${n}</span>`:n).join(" ")}}},U={class:"user-profile"},x=["src"],F={class:"user-info"},A={class:"username_user"},L=t("p",{class:"comments_user"},"Comments",-1),w={class:"comments_user"},N={class:"character-images"},S=["src","alt","onClick"],E={class:"buttons"},D=["disabled"],R=["disabled"],T={class:"user-comments"},B={class:"image-container"},O=["src"],V={class:"content-container"},W={class:"post-header"},H={class:"username"},j={class:"date"},z=["innerHTML"],Y=["disabled"],q=["disabled"],G={class:"user-friends"},J=t("p",{class:"friend-title"},"Friends",-1),K={class:"friend-list"};function Q(r,e,i,n,o,a){const p=y("router-link");return c(),l("div",U,[t("div",{class:g(["profile-box",{"light-mode-profile":o.isLightMode}])},[t("img",{src:o.userInfo.idicon,alt:"User Avatar",onClick:e[0]||(e[0]=(...s)=>a.toggleModal&&a.toggleModal(...s))},null,8,x),t("div",F,[t("p",A,d(o.userInfo.username),1),L,t("p",w,d(this.num_comments),1)]),t("button",{onClick:e[1]||(e[1]=(...s)=>a.logout&&a.logout(...s))},"Logout"),(c(),P(I,{to:"body"},[o.isModalOpen?(c(),l("div",{key:0,class:g(["modalImage",{"light-mode-moddalimg":o.isLightMode}])},[t("div",N,[(c(!0),l(u,null,h(o.rickAndMortyCharacters,s=>(c(),l("img",{src:s.image,alt:s.name,onClick:_=>a.selectCharacter(s),class:"character-image",key:s.id},null,8,S))),128))]),t("div",E,[t("button",{onClick:e[2]||(e[2]=(...s)=>a.previousPageImage&&a.previousPageImage(...s)),disabled:o.page===1},"Previous",8,D),t("span",null,d(o.page),1),t("button",{onClick:e[3]||(e[3]=(...s)=>a.nextPageImage&&a.nextPageImage(...s)),disabled:o.page===o.totalPagesImage},"Next",8,R),t("button",{onClick:e[4]||(e[4]=(...s)=>a.toggleModal&&a.toggleModal(...s))},"Close")])],2)):v("",!0)]))],2),t("div",T,[(c(!0),l(u,null,h(a.paginatedComments,s=>(c(),l("article",{key:s.id,class:g(["comment-user",{"light-mode-comuser":o.isLightMode}])},[t("div",B,[t("img",{src:o.userInfo.idicon,alt:"User icon",class:"user-icon"},null,8,O)]),t("div",V,[t("header",W,[t("p",H,d(s.username),1),t("p",j,d(a.formatDate(s.created_at)),1)]),t("p",{class:"post-content",innerHTML:a.formatComment(s.texto)},null,8,z)])],2))),128)),t("div",{class:g(["button-container",{"light-mode-buttonuser":o.isLightMode}])},[t("button",{onClick:e[5]||(e[5]=(...s)=>a.previousPage&&a.previousPage(...s)),disabled:o.currentPage===1},"Previous",8,Y),t("button",{onClick:e[6]||(e[6]=(...s)=>a.nextPage&&a.nextPage(...s)),disabled:o.currentPage===a.totalPages},"Next",8,q)],2)]),t("div",G,[t("div",{class:g(["friends-box",{"light-mode-profile":o.isLightMode}])},[J,t("div",K,[t("ul",null,[(c(!0),l(u,null,h(o.userFriends,s=>(c(),l("li",{key:s},[C(p,{onClick:_=>a.saveFriendAndNavigate(s),to:"/other-user"},{default:k(()=>[M(d(s),1)]),_:2},1032,["onClick"])]))),128))])])],2)])])}const $=f(b,[["render",Q]]);export{$ as default};
