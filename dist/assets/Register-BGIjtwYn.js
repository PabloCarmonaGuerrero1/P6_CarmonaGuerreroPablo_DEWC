import{a as h}from"./axios-Bo0ATomq.js";import{_ as c,c as o,a as t,g as d,v as p,t as n,d as l,h as v,n as b,o as i}from"./index-Co1rkqzz.js";const w={data(){return{username:"",password:"",repeat:"",errors:{username:"",password:"",repeat:"",usernameTaken:""},submitDisabled:!1,isLightMode:localStorage.getItem("light-mode")==="true"}},methods:{async validateUsernameAvailability(){try{const e=`http://localhost:80/api/auth/users/${this.username}/availability`,r=await h.get(e);this.errors.usernameTaken=""}catch(e){e.response&&e.response.status===404?this.errors.usernameTaken="Username is already taken":this.errors.usernameTaken="",console.error("Error checking username availability:",e)}},validateName(){const e=this.username.replace(/\s/g,"").length;e<4||e>12?(this.errors.username="Username must be at least 4 characters long",this.errors.usernameTaken=""):this.errors.username="",this.updateSubmitDisabled()},validatePassword(){this.password.length<8||this.password.includes(" ")?this.errors.password="Password must be at least 8 characters long and cannot contain spaces":this.errors.password="",this.updateSubmitDisabled()},validateRepeat(){this.password!==this.repeat?this.errors.repeat="Passwords do not match":this.errors.repeat="",this.updateSubmitDisabled()},updateSubmitDisabled(){this.submitDisabled=Object.values(this.errors).some(e=>e!=="")},async registerUser(){try{const e="http://localhost:80/api/v1/users",r={username:this.username,password:this.password,idicon:"https://rickandmortyapi.com/api/character/avatar/1.jpeg"},u=await h.post(e,r);console.log("Respuesta del servidor:",u.data),this.$router.push("/login")}catch(e){e.response?(console.error("Server responded with an error status:",e.response.status),console.error("Error data:",e.response.data)):e.request?console.error("No response received from the server"):console.error("Error setting up the request:",e.message)}},validateAndSubmit(){this.validateName(),this.validatePassword(),this.validateRepeat(),this.validateUsernameAvailability(),this.submitDisabled||this.registerUser()}},watch:{username:"validateName",password:"validatePassword",repeat:"validateRepeat"}},g=t("p",null,"Username",-1),f={key:0,class:"error"},y={key:1,class:"error"},k=t("p",null,"Password",-1),_={key:0,class:"error"},U=t("p",null,"Repeat Password",-1),D={key:0,class:"error"},S=["disabled"];function R(e,r,u,T,s,m){return i(),o("form",{class:b(["Register",{"light-mode-titleform":s.isLightMode}])},[t("label",null,[g,d(t("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=a=>s.username=a)},null,512),[[p,s.username]]),s.errors.username?(i(),o("div",f,n(s.errors.username),1)):l("",!0),s.errors.usernameTaken?(i(),o("div",y,n(s.errors.usernameTaken),1)):l("",!0)]),t("label",null,[k,d(t("input",{type:"password","onUpdate:modelValue":r[1]||(r[1]=a=>s.password=a)},null,512),[[p,s.password]]),s.errors.password?(i(),o("div",_,n(s.errors.password),1)):l("",!0)]),t("label",null,[U,d(t("input",{type:"password","onUpdate:modelValue":r[2]||(r[2]=a=>s.repeat=a)},null,512),[[p,s.repeat]]),s.errors.repeat?(i(),o("div",D,n(s.errors.repeat),1)):l("",!0)]),t("button",{onClick:r[3]||(r[3]=v((...a)=>m.validateAndSubmit&&m.validateAndSubmit(...a),["prevent"])),disabled:s.submitDisabled},"Register",8,S)],2)}const N=c(w,[["render",R]]);export{N as default};
