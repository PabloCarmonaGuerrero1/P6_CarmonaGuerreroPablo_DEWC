import{a as c}from"./axios-Bo0ATomq.js";import{_ as g,c as d,a as o,t as l,d as u,n as m,F as p,f,o as h}from"./index-Co1rkqzz.js";const _={data(){return{username:"",otherUserInfo:{},isFriend:!1,commentInfo:[],currentPage:1,commentsPerPage:3,num_comments:0,isLightMode:localStorage.getItem("light-mode")==="true"}},mounted(){this.username=localStorage.getItem("username"),this.loadUserData()},computed:{totalPages(){return Math.ceil(this.commentInfo.length/this.commentsPerPage)},paginatedComments(){const t=(this.currentPage-1)*this.commentsPerPage,e=t+this.commentsPerPage;return this.commentInfo.slice(t,e)}},methods:{async loadUserData(){const t=localStorage.getItem("username"),e=localStorage.getItem("selectedFriend");try{console.log("Loading user data...");const s=await this.checkFriendshipStatus(t,e);console.log("isFriendFromAPI:",s),await this.getUserInfo(e),await this.getComments(e),console.log("Updating isFriend..."),this.isFriend=s}catch(s){console.error("Error loading user data:",s)}},async toggleFriendship(){const t=localStorage.getItem("selectedFriend"),e=localStorage.getItem("username");try{if(this.isFriend)await c.delete(`http://localhost/api/v1/friendships/${e}/${t}`),await c.delete(`http://localhost/api/v1/friendships/${t}/${e}`),console.log("Amistad eliminada exitosamente");else{const s={username:e,username_friend:t};await c.post("http://localhost/api/v1/friendships",s);const n={username:t,username_friend:e};await c.post("http://localhost/api/v1/friendships",n),console.log("Amistad creada exitosamente")}this.isFriend=!this.isFriend}catch(s){console.error("Error al manejar la amistad:",s.response.data)}},async getUserInfo(t){try{const e=`http://localhost/api/v1/users/${t}`,s=await c.get(e);this.otherUserInfo=s.data}catch(e){console.error("Error fetching other user information:",e)}},async getComments(t){try{const e=`http://localhost/api/v1/comments/${t}`,s=await c.get(e);this.commentInfo=s.data,this.num_comments=this.commentInfo.length,this.commentInfo.sort((n,r)=>n.created_at>r.created_at?-1:n.created_at<r.created_at?1:n.id-r.id)}catch(e){console.error("Error fetching comments:",e)}},formatDate(t){const e=new Date(t);return`${e.getDate()}/${e.getMonth()+1}/${e.getFullYear()}`},async checkFriendshipStatus(t,e){try{console.log("Checking friendship status...");const s=await c.get(`http://localhost/api/v1/friendships/${t}/${e}`);return console.log("Friendship status response:",s.data),!0}catch(s){return console.error("Error checking friendship status:",s),!1}},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},previousPage(){this.currentPage>1&&this.currentPage--},formatComment(t){return t.split(" ").map(n=>n.startsWith("#")?`<span class="hashtag">${n}</span>`:n).join(" ")}}},P={class:"other-user-profile"},F=["src"],I={class:"other-info"},v={class:"username-other"},U={class:"comments-other"},x={class:"other-comments"},y={class:"image-container"},C=["src"],k={class:"content-container"},w={class:"post-header"},S={class:"username"},b={class:"date"},D=["innerHTML"],M=["disabled"],L=["disabled"];function A(t,e,s,n,r,a){return h(),d("div",P,[o("div",{class:m(["other-profile-box",{"light-mode-otherprofile":r.isLightMode}])},[o("img",{src:r.otherUserInfo.idicon,alt:"User Avatar"},null,8,F),o("div",I,[o("p",v,l(r.otherUserInfo.username),1),o("p",U,"Comments: "+l(r.num_comments),1)]),r.otherUserInfo.username!==r.username&&r.username?(h(),d("button",{key:0,onClick:e[0]||(e[0]=(...i)=>a.toggleFriendship&&a.toggleFriendship(...i))},l(r.isFriend?"Stop being friends":"Add friend"),1)):u("",!0)],2),o("div",x,[(h(!0),d(p,null,f(a.paginatedComments,i=>(h(),d("article",{key:i.id,class:m(["Mensaje",{"light-mode-othercomments":r.isLightMode}])},[o("div",y,[o("img",{src:r.otherUserInfo.idicon,alt:"User icon",class:"user-icon"},null,8,C)]),o("div",k,[o("header",w,[o("p",S,l(i.username),1),o("p",b,l(a.formatDate(i.created_at)),1)]),o("p",{class:"post-content",innerHTML:a.formatComment(i.texto)},null,8,D)])],2))),128)),o("div",{class:m(["button-container",{"light-mode-buttonsother":r.isLightMode}])},[o("button",{onClick:e[1]||(e[1]=(...i)=>a.previousPage&&a.previousPage(...i)),disabled:r.currentPage===1},"Previous",8,M),o("button",{onClick:e[2]||(e[2]=(...i)=>a.nextPage&&a.nextPage(...i)),disabled:r.currentPage===a.totalPages},"Next",8,L)],2)])])}const B=g(_,[["render",A]]);export{B as default};
